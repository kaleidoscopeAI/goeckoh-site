const activ = entry.activations ?? new Array(M).fill(1); // fallback ones
for (let i = 0; i < N; i++) {
const k = Ki[i];
