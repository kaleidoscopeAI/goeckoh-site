# Interactive spinner goes directly to sys.stdout rather than being routed
# through the logging system, but it acts like it has level INFO,
# i.e. it's only displayed if we're at level INFO or better.
# Non-interactive spinner goes through the logging system, so it is always
# in sync with logging configuration.
if sys.stdout.isatty() and logger.getEffectiveLevel() <= logging.INFO:
    spinner: SpinnerInterface = InteractiveSpinner(message)
else:
    spinner = NonInteractiveSpinner(message)
try:
    with hidden_cursor(sys.stdout):
        yield spinner
except KeyboardInterrupt:
    spinner.finish("canceled")
    raise
except Exception:
    spinner.finish("error")
    raise
else:
    spinner.finish("done")


