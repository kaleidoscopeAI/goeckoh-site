      qv = embed_text(query)
      sims = (E @ qv) / (np.linalg.norm(E,axis=1) * (np.linalg.norm(qv)+1e-9) + 1e-12)
      order = np.argsort(-sims)[:k]
      return [ids[i] for i in order], [float(sims[i]) for i in order]

