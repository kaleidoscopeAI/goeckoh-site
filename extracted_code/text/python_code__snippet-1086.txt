"""
Check whether the given Python version is compatible with a distribution's
"Requires-Python" value.

:param version_info: A 3-tuple of ints representing the Python
    major-minor-micro version to check.
:param ignore_requires_python: Whether to ignore the "Requires-Python"
    value if the given Python version isn't compatible.

:raises UnsupportedPythonVersion: When the given Python version isn't
    compatible.
"""
# This idiosyncratically converts the SpecifierSet to str and let
# check_requires_python then parse it again into SpecifierSet. But this
# is the legacy resolver so I'm just not going to bother refactoring.
try:
    requires_python = str(dist.requires_python)
except FileNotFoundError as e:
    raise NoneMetadataError(dist, str(e))
try:
    is_compatible = check_requires_python(
        requires_python,
        version_info=version_info,
    )
except specifiers.InvalidSpecifier as exc:
    logger.warning(
        "Package %r has an invalid Requires-Python: %s", dist.raw_name, exc
    )
    return

if is_compatible:
    return

version = ".".join(map(str, version_info))
if ignore_requires_python:
    logger.debug(
        "Ignoring failed Requires-Python check for package %r: %s not in %r",
        dist.raw_name,
        version,
        requires_python,
    )
    return

raise UnsupportedPythonVersion(
    "Package {!r} requires a different Python: {} not in {!r}".format(
        dist.raw_name, version, requires_python
    )
)


