return w * (popcount(xor(ei, ej)) / d)


