m = ENTRY_RE.search(specification)
if not m:
    result = None
    if '[' in specification or ']' in specification:
        raise DistlibException("Invalid specification "
                               "'%s'" % specification)
else:
    d = m.groupdict()
    name = d['name']
    path = d['callable']
    colons = path.count(':')
    if colons == 0:
        prefix, suffix = path, None
    else:
        if colons != 1:
            raise DistlibException("Invalid specification "
                                   "'%s'" % specification)
        prefix, suffix = path.split(':')
    flags = d['flags']
    if flags is None:
        if '[' in specification or ']' in specification:
            raise DistlibException("Invalid specification "
                                   "'%s'" % specification)
        flags = []
    else:
        flags = [f.strip() for f in flags.split(',')]
    result = ExportEntry(name, prefix, suffix, flags)
return result


