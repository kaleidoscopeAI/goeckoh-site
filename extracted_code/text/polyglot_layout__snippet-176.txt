  rows = []
  for i, p in enumerate(root.rglob("*")):
      if i >= cap:
          break
      if p.is_file():
          try:
               size = p.stat().st_size
          except Exception:
               size = None
          rel = p.relative_to(root).as_posix()
          rows.append({
               "root": root.name,
               "relpath": rel,
               "name": p.name,
               "ext": p.suffix.lower(),
               "size_bytes": size
          })
  return rows

