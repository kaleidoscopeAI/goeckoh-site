try:
    if isinstance(s, (bytes, bytearray)):
        s = s.decode('ascii')
except UnicodeDecodeError:
    raise IDNAError('Invalid ASCII in A-label')
if uts46:
    s = uts46_remap(s, std3_rules, False)
trailing_dot = False
result = []
if not strict:
    labels = _unicode_dots_re.split(s)
else:
    labels = s.split('.')
if not labels or labels == ['']:
    raise IDNAError('Empty domain')
if not labels[-1]:
    del labels[-1]
    trailing_dot = True
for label in labels:
    s = ulabel(label)
    if s:
        result.append(s)
    else:
        raise IDNAError('Empty label')
if trailing_dot:
    result.append('')
return '.'.join(result)


