"""Build one unpacked package using the "legacy" build process.

Returns path to wheel if successfully built. Otherwise, returns None.
"""
wheel_args = make_setuptools_bdist_wheel_args(
    setup_py_path,
    global_options=global_options,
    build_options=build_options,
    destination_dir=tempd,
)

spin_message = f"Building wheel for {name} (setup.py)"
with open_spinner(spin_message) as spinner:
    logger.debug("Destination directory: %s", tempd)

    try:
        output = call_subprocess(
            wheel_args,
            command_desc="python setup.py bdist_wheel",
            cwd=source_dir,
            spinner=spinner,
        )
    except Exception:
        spinner.finish("error")
        logger.error("Failed building wheel for %s", name)
        return None

    names = os.listdir(tempd)
    wheel_path = get_legacy_build_wheel_path(
        names=names,
        temp_dir=tempd,
        name=name,
        command_args=wheel_args,
        command_output=output,
    )
    return wheel_path


