  win = get_window(window, n_fft)
  f, t, Zxx = stft(x, fs=sr, window=win, nperseg=n_fft, noverlap=n_fft - hop_length, boundary=None, padded=True)
  S = np.abs(Zxx)**2
  return f, t, S

