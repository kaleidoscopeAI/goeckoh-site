  workletNode.port.onmessage = (ev) => {
    if (!ev?.data) return;
    applyFeatures(ev.data);
  };

  sourceNode.connect(workletNode);
  sourceNode.connect(analyzerNode);

  setStatus("Running (AudioWorklet)");
  return;
} catch (e) {
  console.warn("AudioWorklet failed, falling back:", e);
}
}

