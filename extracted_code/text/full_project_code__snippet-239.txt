"""
Checks if given fingerprint matches the supplied certificate.

:param cert:
    Certificate as bytes object.
:param fingerprint:
    Fingerprint as string of hexdigits, can be interspersed by colons.
"""

fingerprint = fingerprint.replace(":", "").lower()
digest_length = len(fingerprint)
hashfunc = HASHFUNC_MAP.get(digest_length)
if not hashfunc:
    raise SSLError("Fingerprint of invalid length: {0}".format(fingerprint))

# We need encode() here for py32; works on py2 and p33.
fingerprint_bytes = unhexlify(fingerprint.encode())

cert_digest = hashfunc(cert).digest()

if not _const_compare_digest(cert_digest, fingerprint_bytes):
    raise SSLError(
        'Fingerprints did not match. Expected "{0}", got "{1}".'.format(
            fingerprint, hexlify(cert_digest)
        )
    )


