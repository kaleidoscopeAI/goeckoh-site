Security.SecItemImport.argtypes = [
    CFDataRef,
    CFStringRef,
    POINTER(SecExternalFormat),
    POINTER(SecExternalItemType),
    SecItemImportExportFlags,
    POINTER(SecItemImportExportKeyParameters),
    SecKeychainRef,
    POINTER(CFArrayRef),
]
Security.SecItemImport.restype = OSStatus

Security.SecCertificateGetTypeID.argtypes = []
Security.SecCertificateGetTypeID.restype = CFTypeID

Security.SecIdentityGetTypeID.argtypes = []
Security.SecIdentityGetTypeID.restype = CFTypeID

Security.SecKeyGetTypeID.argtypes = []
Security.SecKeyGetTypeID.restype = CFTypeID

Security.SecCertificateCreateWithData.argtypes = [CFAllocatorRef, CFDataRef]
Security.SecCertificateCreateWithData.restype = SecCertificateRef

Security.SecCertificateCopyData.argtypes = [SecCertificateRef]
Security.SecCertificateCopyData.restype = CFDataRef

Security.SecCopyErrorMessageString.argtypes = [OSStatus, c_void_p]
Security.SecCopyErrorMessageString.restype = CFStringRef

Security.SecIdentityCreateWithCertificate.argtypes = [
    CFTypeRef,
    SecCertificateRef,
    POINTER(SecIdentityRef),
]
Security.SecIdentityCreateWithCertificate.restype = OSStatus

Security.SecKeychainCreate.argtypes = [
    c_char_p,
    c_uint32,
    c_void_p,
    Boolean,
    c_void_p,
    POINTER(SecKeychainRef),
]
Security.SecKeychainCreate.restype = OSStatus

Security.SecKeychainDelete.argtypes = [SecKeychainRef]
Security.SecKeychainDelete.restype = OSStatus

Security.SecPKCS12Import.argtypes = [
    CFDataRef,
    CFDictionaryRef,
    POINTER(CFArrayRef),
]
Security.SecPKCS12Import.restype = OSStatus

SSLReadFunc = CFUNCTYPE(OSStatus, SSLConnectionRef, c_void_p, POINTER(c_size_t))
SSLWriteFunc = CFUNCTYPE(
    OSStatus, SSLConnectionRef, POINTER(c_byte), POINTER(c_size_t)
)

Security.SSLSetIOFuncs.argtypes = [SSLContextRef, SSLReadFunc, SSLWriteFunc]
Security.SSLSetIOFuncs.restype = OSStatus

Security.SSLSetPeerID.argtypes = [SSLContextRef, c_char_p, c_size_t]
Security.SSLSetPeerID.restype = OSStatus

Security.SSLSetCertificate.argtypes = [SSLContextRef, CFArrayRef]
Security.SSLSetCertificate.restype = OSStatus

Security.SSLSetCertificateAuthorities.argtypes = [SSLContextRef, CFTypeRef, Boolean]
Security.SSLSetCertificateAuthorities.restype = OSStatus

Security.SSLSetConnection.argtypes = [SSLContextRef, SSLConnectionRef]
Security.SSLSetConnection.restype = OSStatus

Security.SSLSetPeerDomainName.argtypes = [SSLContextRef, c_char_p, c_size_t]
Security.SSLSetPeerDomainName.restype = OSStatus

Security.SSLHandshake.argtypes = [SSLContextRef]
Security.SSLHandshake.restype = OSStatus

Security.SSLRead.argtypes = [SSLContextRef, c_char_p, c_size_t, POINTER(c_size_t)]
Security.SSLRead.restype = OSStatus

Security.SSLWrite.argtypes = [SSLContextRef, c_char_p, c_size_t, POINTER(c_size_t)]
Security.SSLWrite.restype = OSStatus

Security.SSLClose.argtypes = [SSLContextRef]
Security.SSLClose.restype = OSStatus

Security.SSLGetNumberSupportedCiphers.argtypes = [SSLContextRef, POINTER(c_size_t)]
Security.SSLGetNumberSupportedCiphers.restype = OSStatus

Security.SSLGetSupportedCiphers.argtypes = [
    SSLContextRef,
    POINTER(SSLCipherSuite),
    POINTER(c_size_t),
]
Security.SSLGetSupportedCiphers.restype = OSStatus

Security.SSLSetEnabledCiphers.argtypes = [
    SSLContextRef,
    POINTER(SSLCipherSuite),
    c_size_t,
]
Security.SSLSetEnabledCiphers.restype = OSStatus

Security.SSLGetNumberEnabledCiphers.argtype = [SSLContextRef, POINTER(c_size_t)]
Security.SSLGetNumberEnabledCiphers.restype = OSStatus

Security.SSLGetEnabledCiphers.argtypes = [
    SSLContextRef,
    POINTER(SSLCipherSuite),
    POINTER(c_size_t),
]
Security.SSLGetEnabledCiphers.restype = OSStatus

Security.SSLGetNegotiatedCipher.argtypes = [SSLContextRef, POINTER(SSLCipherSuite)]
Security.SSLGetNegotiatedCipher.restype = OSStatus

Security.SSLGetNegotiatedProtocolVersion.argtypes = [
    SSLContextRef,
    POINTER(SSLProtocol),
]
Security.SSLGetNegotiatedProtocolVersion.restype = OSStatus

Security.SSLCopyPeerTrust.argtypes = [SSLContextRef, POINTER(SecTrustRef)]
Security.SSLCopyPeerTrust.restype = OSStatus

Security.SecTrustSetAnchorCertificates.argtypes = [SecTrustRef, CFArrayRef]
Security.SecTrustSetAnchorCertificates.restype = OSStatus

Security.SecTrustSetAnchorCertificatesOnly.argstypes = [SecTrustRef, Boolean]
Security.SecTrustSetAnchorCertificatesOnly.restype = OSStatus

Security.SecTrustEvaluate.argtypes = [SecTrustRef, POINTER(SecTrustResultType)]
Security.SecTrustEvaluate.restype = OSStatus

Security.SecTrustGetCertificateCount.argtypes = [SecTrustRef]
Security.SecTrustGetCertificateCount.restype = CFIndex

Security.SecTrustGetCertificateAtIndex.argtypes = [SecTrustRef, CFIndex]
Security.SecTrustGetCertificateAtIndex.restype = SecCertificateRef

Security.SSLCreateContext.argtypes = [
    CFAllocatorRef,
    SSLProtocolSide,
    SSLConnectionType,
]
Security.SSLCreateContext.restype = SSLContextRef

Security.SSLSetSessionOption.argtypes = [SSLContextRef, SSLSessionOption, Boolean]
Security.SSLSetSessionOption.restype = OSStatus

Security.SSLSetProtocolVersionMin.argtypes = [SSLContextRef, SSLProtocol]
Security.SSLSetProtocolVersionMin.restype = OSStatus

Security.SSLSetProtocolVersionMax.argtypes = [SSLContextRef, SSLProtocol]
Security.SSLSetProtocolVersionMax.restype = OSStatus

try:
    Security.SSLSetALPNProtocols.argtypes = [SSLContextRef, CFArrayRef]
    Security.SSLSetALPNProtocols.restype = OSStatus
except AttributeError:
    # Supported only in 10.12+
    pass

Security.SecCopyErrorMessageString.argtypes = [OSStatus, c_void_p]
Security.SecCopyErrorMessageString.restype = CFStringRef

Security.SSLReadFunc = SSLReadFunc
Security.SSLWriteFunc = SSLWriteFunc
Security.SSLContextRef = SSLContextRef
Security.SSLProtocol = SSLProtocol
Security.SSLCipherSuite = SSLCipherSuite
Security.SecIdentityRef = SecIdentityRef
Security.SecKeychainRef = SecKeychainRef
Security.SecTrustRef = SecTrustRef
Security.SecTrustResultType = SecTrustResultType
Security.SecExternalFormat = SecExternalFormat
Security.OSStatus = OSStatus

Security.kSecImportExportPassphrase = CFStringRef.in_dll(
    Security, "kSecImportExportPassphrase"
)
Security.kSecImportItemIdentity = CFStringRef.in_dll(
    Security, "kSecImportItemIdentity"
)

# CoreFoundation time!
CoreFoundation.CFRetain.argtypes = [CFTypeRef]
CoreFoundation.CFRetain.restype = CFTypeRef

CoreFoundation.CFRelease.argtypes = [CFTypeRef]
CoreFoundation.CFRelease.restype = None

CoreFoundation.CFGetTypeID.argtypes = [CFTypeRef]
CoreFoundation.CFGetTypeID.restype = CFTypeID

CoreFoundation.CFStringCreateWithCString.argtypes = [
    CFAllocatorRef,
    c_char_p,
    CFStringEncoding,
]
CoreFoundation.CFStringCreateWithCString.restype = CFStringRef

CoreFoundation.CFStringGetCStringPtr.argtypes = [CFStringRef, CFStringEncoding]
CoreFoundation.CFStringGetCStringPtr.restype = c_char_p

CoreFoundation.CFStringGetCString.argtypes = [
    CFStringRef,
    c_char_p,
    CFIndex,
    CFStringEncoding,
]
CoreFoundation.CFStringGetCString.restype = c_bool

CoreFoundation.CFDataCreate.argtypes = [CFAllocatorRef, c_char_p, CFIndex]
CoreFoundation.CFDataCreate.restype = CFDataRef

CoreFoundation.CFDataGetLength.argtypes = [CFDataRef]
CoreFoundation.CFDataGetLength.restype = CFIndex

CoreFoundation.CFDataGetBytePtr.argtypes = [CFDataRef]
CoreFoundation.CFDataGetBytePtr.restype = c_void_p

CoreFoundation.CFDictionaryCreate.argtypes = [
    CFAllocatorRef,
    POINTER(CFTypeRef),
    POINTER(CFTypeRef),
    CFIndex,
    CFDictionaryKeyCallBacks,
    CFDictionaryValueCallBacks,
]
CoreFoundation.CFDictionaryCreate.restype = CFDictionaryRef

CoreFoundation.CFDictionaryGetValue.argtypes = [CFDictionaryRef, CFTypeRef]
CoreFoundation.CFDictionaryGetValue.restype = CFTypeRef

CoreFoundation.CFArrayCreate.argtypes = [
    CFAllocatorRef,
    POINTER(CFTypeRef),
    CFIndex,
    CFArrayCallBacks,
]
CoreFoundation.CFArrayCreate.restype = CFArrayRef

CoreFoundation.CFArrayCreateMutable.argtypes = [
    CFAllocatorRef,
    CFIndex,
    CFArrayCallBacks,
]
CoreFoundation.CFArrayCreateMutable.restype = CFMutableArrayRef

CoreFoundation.CFArrayAppendValue.argtypes = [CFMutableArrayRef, c_void_p]
CoreFoundation.CFArrayAppendValue.restype = None

CoreFoundation.CFArrayGetCount.argtypes = [CFArrayRef]
CoreFoundation.CFArrayGetCount.restype = CFIndex

CoreFoundation.CFArrayGetValueAtIndex.argtypes = [CFArrayRef, CFIndex]
CoreFoundation.CFArrayGetValueAtIndex.restype = c_void_p

CoreFoundation.kCFAllocatorDefault = CFAllocatorRef.in_dll(
    CoreFoundation, "kCFAllocatorDefault"
)
CoreFoundation.kCFTypeArrayCallBacks = c_void_p.in_dll(
    CoreFoundation, "kCFTypeArrayCallBacks"
)
CoreFoundation.kCFTypeDictionaryKeyCallBacks = c_void_p.in_dll(
    CoreFoundation, "kCFTypeDictionaryKeyCallBacks"
)
CoreFoundation.kCFTypeDictionaryValueCallBacks = c_void_p.in_dll(
    CoreFoundation, "kCFTypeDictionaryValueCallBacks"
)

CoreFoundation.CFTypeRef = CFTypeRef
CoreFoundation.CFArrayRef = CFArrayRef
CoreFoundation.CFStringRef = CFStringRef
CoreFoundation.CFDictionaryRef = CFDictionaryRef

