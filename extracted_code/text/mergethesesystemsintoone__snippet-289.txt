  for i, target_word in enumerate(sentence):
      if target_word not in self.vocabulary:
          continue

      # Get context words within the window
      context_words = sentence[max(0, i - self.window): i] + sentence[i + 1: min(len(sentence), i + self.window + 1)]
      for context_word in context_words:
          if context_word not in self.vocabulary:
              continue

          # Negative sampling
          negative_samples = self._get_negative_samples(context_word)

          # Update vectors
          self._update_vectors(target_word, context_word, negative_samples)

