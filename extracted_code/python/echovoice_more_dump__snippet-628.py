def optimize_p(self, S, R, I, P, S_target, lr=0.01, lambda_reg=0.01, max_opt_iter=20):
