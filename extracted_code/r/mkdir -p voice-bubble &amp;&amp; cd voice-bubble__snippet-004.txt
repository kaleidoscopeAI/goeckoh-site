library(effsize)

# From subject-level means/SDs (N subjects)
compute_paired_d <- function(mean_pre, sd_pre, mean_post, sd_post, n_subjects) {
  # Paired difference approach (preferred)
  mean_diff <- mean_pre - mean_post
  sd_diff <- sqrt( (sd_pre^2 + sd_post^2 - 2 * cor * sd_pre * sd_post) / 2 )
  d_paired <- mean_diff / sd_diff
  
  # Or use effsize package directly on paired data
  # cohen.d(pre, post, paired=TRUE)
  
  return(d_paired)
}

# Example usage
d <- compute_paired_d(mean_pre= -4.2, sd_pre=2.1, mean_post= -2.8, sd_post=1.9, n=20)
print(paste("Paired d =", round(d, 2)))
