class CrystallineHeart(private val nNodes: Int) {
    // ... (unchanged)
